ВАРИАНТ 6.
=========
Уровень 1
---------
1. Дана схема базы данных в виде следующих отношений. С помощью операторов SQL создать логическую структуру соответствующих таблиц для хранения в СУБД, используя известные средства поддержания целостности (NOT NULL, UNIQUE, и т.д.). Обосновать выбор типов данных и используемые средства поддержания целостности. При выборе подходящих типов данных использовать информацию о конкретных значениях полей БД (см. прил.1)

ПОТРЕБИТЕЛЬ
ИДЕНТИФИКАТОР | НАЗВАНИЕ | АДРЕС ЖИТЕЛЬСТВА | СКИДКА,%
--------------|----------|------------------|---------

ПОСТАВЩИК
ИДЕНТИФИКАТОР  |ФАМИЛИЯ  |АДРЕС  |КОММИСИОННЫЕ,%
---------------|---------|-------|--------------

ЗАКАЗ
НОМЕР  |ДАТА  |ПОТРЕБИТЕЛЬ  |ПОСТАВЩИК  |ДЕТАЛЬ  |КОЛ-ВО  |СУММА, РУБ
-------|------|-------------|-----------|--------|--------|----------

ДЕТАЛЬ
ИДЕНТИФИКАТОР  |НАИМЕНОВАНИЕ  |СКЛАД  |КОЛ-ВО  |ЦЕНА, РУБ
---------------|--------------|-------|--------|---------

```SQL
CREATE TABLE `ПОТРЕБИТЕЛЬ` (
  `ИДЕНТИФИКАТОР` int(11) NOT NULL AUTO_INCREMENT,
  `НАЗВАНИЕ` varchar(255) NOT NULL,
  `АДРЕС ЖИТЕЛЬСТВА` varchar(255) NOT NULL,
  `СКИДКА, %` int(11) NOT NULL,
  PRIMARY KEY(`ИДЕНТИФИКАТОР`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `ПОСТАВЩИК` (
  `ИДЕНТИФИКАТОР` int(11) NOT NULL AUTO_INCREMENT,
  `ФАМИЛИЯ` varchar(20) NOT NULL,
  `АДРЕС` varchar(30) NOT NULL,
  `КОММИСИОННЫЕ,%` int(11) NOT NULL,
  PRIMARY KEY(`ИДЕНТИФИКАТОР`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `ЗАКАЗ` (
  `НОМЕР` int(11) NOT NULL AUTO_INCREMENT,
  `ДАТА` varchar(20) NOT NULL,
  `ПОТРЕБИТЕЛЬ` int(11) NOT NULL,
  `ПОСТАВЩИК` int(11) NOT NULL,
  `ДЕТАЛЬ` int(11) NOT NULL,
  `КОЛ-ВО` int(11) NOT NULL,
  `СУММА, РУБ` int(11) NOT NULL,
  PRIMARY KEY(`НОМЕР`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `ДЕТАЛЬ` (
  `ИДЕНТИФИКАТОР` int(11) NOT NULL AUTO_INCREMENT,
  `НАИМЕНОВАНИЕ` varchar(20) NOT NULL,
  `СКЛАД` varchar(20) NOT NULL,
  `КОЛ-ВО` int(11) NOT NULL,
  `ЦЕНА, РУБ` int(11) NOT NULL,
  PRIMARY KEY(`ИДЕНТИФИКАТОР`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

ALTER TABLE ПОТРЕБИТЕЛЬ CHECK (`СКИДКА, %` <= 100 AND `СКИДКА, %` >= 0);
ALTER TABLE ПОСТАВЩИК CHECK (`КОММИСИОННЫЕ,%` <= 100 AND `КОММИСИОННЫЕ,%` >= 0);
ALTER TABLE ЗАКАЗ CHECK (`КОЛ-ВО` >= 0 AND `СУММА, РУБ` > 0);
ALTER TABLE ДЕТАЛЬ CHECK (`КОЛ-ВО` >= 0 AND `ЦЕНА, РУБ` > 0);
```
2. Ввести в ранее созданные таблицы конкретные данные (см. прил. 1). Использовать скрипт-файл из операторов INSERT или вспомогательную утилиту .
```SQL
INSERT INTO `ПОТРЕБИТЕЛЬ` (`ИДЕНТИФИКАТОР`, `НАЗВАНИЕ`, `АДРЕС ЖИТЕЛЬСТВА`, `СКИДКА, %`) VALUES
(1, 'АО ВАРЯ', 'Сормовский', 10),
(2, 'ГАЗ', 'Автозаводский', 7),
(3, 'МП ВЕРА', 'Канавинский', 5),
(4, 'МП', 'Канавинский', 3),
(5, 'АО СТАЛЬ', 'Советский', 0);

INSERT INTO `ПОСТАВЩИК` (`ИДЕНТИФИКАТОР`, `ФАМИЛИЯ`, `АДРЕС`, `КОММИСИОННЫЕ,%`) VALUES
(1, 'Артюхина', 'Сормовский', 4),
(2, 'Щепин', 'Приокский', 4),
(3, 'Власов', 'Канавинский', 5),
(4, 'Кузнецова', 'Советский', 5),
(5, 'Цепилева', 'Нижегородский', 3),
(6, 'Корнилов', 'Нижегородский', 6);

INSERT INTO `ЗАКАЗ` (`НОМЕР`, `ДАТА`, `ПОТРЕБИТЕЛЬ`, `ПОСТАВЩИК`, `ДЕТАЛЬ`, `КОЛ-ВО`, `СУММА, РУБ`) VALUES
(1, 'Январь', 5, 4, 3, 7, 21000),
(2, 'Февраль', 3, 3, 3, 2, 6000),
(3, 'Февраль', 4, 5, 4, 200, 180000),
(4, 'Март', 5, 4, 2, 50, 50000),
(5, 'Апрель', 1, 6, 7, 110, 132000),
(6, 'Апрель', 4, 4, 1, 150, 750000),
(7, 'Май', 2, 4, 6, 20, 40000),
(8, 'Июнь', 1, 3, 7, 2000, 2400000),
(9, 'Июнь', 2, 5, 7, 10000, 12000000),
(10, 'Июнь', 3, 6, 1, 5, 25000),
(11, 'Июнь', 4, 3, 3, 1, 3000),
(12, 'Июнь', 4, 4, 1, 10, 50000),
(13, 'Июль', 1, 6, 6, 3, 6000),
(14, 'Июль', 2, 1, 2, 1000, 1000000),
(15, 'Июль', 2, 2, 1, 100, 5000000),
(16, 'Июль', 5, 1, 5, 100, 15000),
(17, 'Август', 1, 4, 7, 12000, 24400000);

INSERT INTO `ДЕТАЛЬ` (`ИДЕНТИФИКАТОР`, `НАИМЕНОВАНИЕ`, `СКЛАД`, `КОЛ-ВО`, `ЦЕНА, РУБ`) VALUES
(1, 'Втулка', 'Сормовский', 20000, 5000),
(2, 'Болт', 'Сормовский', 40000, 1000),
(3, 'Ключ гаечный', 'Канавинский', 5000, 3000),
(4, 'Шпилька', 'Автозаводский', 10000, 900),
(5, 'Винт', 'Сормовский', 50000, 1500),
(6, 'Молоток', 'Канавинский', 1200, 2000),
(7, 'Шуруп', 'Сормовский', 30000, 1200);
```

3. Используя оператор SELECT создать запрос для вывода всех строк каждой таблицы. Проверить правильность ввода. При необходимости произвести коррекцию значений операторами INSERT, UPDATE, DELETE.
```sql
SELECT * FROM ПОТРЕБИТЕЛЬ;

| ИДЕНТИФИКАТОР | НАЗВАНИЕ | АДРЕС ЖИТЕЛЬСТВА | СКИДКА, % |
|---------------|----------|------------------|-----------|
|             1 | АО ВАРЯ  | Сормовский       |        10 |
|             2 | ГАЗ      | Автозаводский    |         7 |
|             3 | МП ВЕРА  | Канавинский      |         5 |
|             4 | МП       | Канавинский      |         3 |
|             5 | АО СТАЛЬ | Советский        |         0 |

SELECT * FROM ПОТРЕБИТЕЛЬ;
| ИДЕНТИФИКАТОР | ФАМИЛИЯ   | АДРЕС         | КОММИСИОННЫЕ,% |
|---------------|-----------|---------------|----------------|
|             1 | Артюхина  | Сормовский    |              4 |
|             2 | Щепин     | Приокский     |              4 |
|             3 | Власов    | Канавинский   |              5 |
|             4 | Кузнецова | Советский     |              5 |
|             5 | Цепилева  | Нижегородский |              3 |
|             6 | Корнилов  | Нижегородский |              6 |

SELECT * FROM ЗАКАЗ;
| НОМЕР | ДАТА    | ПОТРЕБИТЕЛЬ | ПОСТАВЩИК | ДЕТАЛЬ | КОЛ-ВО | СУММА, РУБ |
|-------|---------|-------------|-----------|--------|--------|------------|
|     1 | Январь  |           5 |         4 |      3 |      7 |      21000 |
|     2 | Февраль |           3 |         3 |      3 |      2 |       6000 |
|     3 | Февраль |           4 |         5 |      4 |    200 |     180000 |
|     4 | Март    |           5 |         4 |      2 |     50 |      50000 |
|     5 | Апрель  |           1 |         6 |      7 |    110 |     132000 |
|     6 | Апрель  |           4 |         4 |      1 |    150 |     750000 |
|     7 | Май     |           2 |         4 |      6 |     20 |      40000 |
|     8 | Июнь    |           1 |         3 |      7 |   2000 |    2400000 |
|     9 | Июнь    |           2 |         5 |      7 |  10000 |   12000000 |
|    10 | Июнь    |           3 |         6 |      1 |      5 |      25000 |
|    11 | Июнь    |           4 |         3 |      3 |      1 |       3000 |
|    12 | Июнь    |           4 |         4 |      1 |     10 |      50000 |
|    13 | Июль    |           1 |         6 |      6 |      3 |       6000 |
|    14 | Июль    |           2 |         1 |      2 |   1000 |    1000000 |
|    15 | Июль    |           2 |         2 |      1 |    100 |    5000000 |
|    16 | Июль    |           5 |         1 |      5 |    100 |      15000 |
|    17 | Август  |           1 |         4 |      7 |  12000 |   24400000 |

SELECT * FROM ДЕТАЛЬ;
| ИДЕНТИФИКАТОР | НАИМЕНОВАНИЕ | СКЛАД         | КОЛ-ВО | ЦЕНА, РУБ |
|---------------|--------------|---------------|--------|-----------|
|             1 | Втулка       | Сормовский    |  20000 |      5000 |
|             2 | Болт         | Сормовский    |  40000 |      1000 |
|             3 | Ключ гаечный | Канавинский   |   5000 |      3000 |
|             4 | Шпилька      | Автозаводский |  10000 |       900 |
|             5 | Винт         | Сормовский    |  50000 |      1500 |
|             6 | Молоток      | Канавинский   |   1200 |      2000 |
|             7 | Шуруп        | Сормовский    |  30000 |      1200 |
  
4. Создать запросы для вывода:
a) всех различных размеров комиссионных;
SELECT DISTINCT `КОММИСИОННЫЕ,%` FROM ПОСТАВЩИК;
| КОММИСИОННЫЕ,% |
|----------------|
|              4 |
|              5 |
|              3 |
|              6 |

b) всех различных фамилий поставщиков;
SELECT DISTINCT `ФАМИЛИЯ` FROM ПОСТАВЩИК;
| ФАМИЛИЯ   |
|-----------|
| Артюхина  |
| Щепин     |
| Власов    |
| Кузнецова |
| Цепилева  |
| Корнилов  |

c) всех различных наименований деталей.
SELECT DISTINCT `НАИМЕНОВАНИЕ` FROM ДЕТАЛЬ;
| НАИМЕНОВАНИЕ |
|--------------|
| Втулка       |
| Болт         |
| Ключ гаечный |
| Шпилька      |
| Винт         |
| Молоток      |
| Шуруп        |

5. Создав запрос получить следующую информацию:
a) фамилии и адреса поставщиков, имеющих размер комиссионных менее 5%;
SELECT ФАМИЛИЯ, АДРЕС,`КОММИСИОННЫЕ,%` FROM ПОСТАВЩИК WHERE `КОММИСИОННЫЕ,%` < 5;
| ФАМИЛИЯ  | АДРЕС         | КОММИСИОННЫЕ,% |
|----------|---------------|-----------------|
| Артюхина | Сормовский    |              4 |
| Щепин    | Приокский     |              4 |
| Цепилева | Нижегородский |              3 |

b) название и адрес склада для деталей, находящихся в количесиве менее 1500 шт.;
SELECT СКЛАД, `КОЛ-ВО`, НАИМЕНОВАНИЕ FROM ДЕТАЛЬ WHERE `КОЛ-ВО` < 1500;
| СКЛАД       | КОЛ-ВО | НАИМЕНОВАНИЕ |
|-------------|--------|--------------|
| Канавинский |   1200 | Молоток      |

c) название, адрес и размер скидки для предприятий, имеющих в названии слово “МП”. Отсортировать по адресу и размеру скидки.
